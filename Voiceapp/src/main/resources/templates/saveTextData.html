<!DOCTYPE html>
<html xmlns:th="https://thymeleaf.org" xmlns="http://www.w3.org/1999/html">
<head>
  <meta charset="UTF-8">
  <title>Text-to-Speech</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
  <script src="https://code.responsivevoice.org/responsivevoice.js?key=eeSEupXA"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>  
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <style>
        .bi{
          font-size:18px;
        }
        .customNav {
          width:100%;
          min-height:88vh;          
          color:white;
        }
        .nilRecord{
          font-size:18px;                    
          padding-top:80%;   
          font-weight:600;              
        }
        .records{
          font-size:18px;          
          padding:20px;          
        }        
        .cutsomAnchor{
          text-decoration:none;          
          color:white;
          font-weight:600;          
        }
        .cutsomAnchor:hover{
          color:red;
        } 
        .nav-link:hover{
          background-color:white;
          color:black;
          font-weight:bold;          
        }       
    </style>
  </head>
<body style="background-color:#E99DCB">
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm">
          <nav class="navbar navbar-expand-lg navbar-dark bg-dark" style="padding:30px;">
            <div class="container-fluid">
              <a class="navbar-brand" href="#"><i class="bi bi-file-text-fill"></i>&nbsp;&nbsp;TextToSpeech&nbsp;&nbsp;<i class="bi bi-file-music-fill"></i></a>
              <div class="collapse navbar-collapse">
                <div class="navbar-nav">                  
                    <a class="nav-link" href="/text-to-speech/dashboard">Features</a> 
                    <a class="nav-link" href="/text-to-speech/save">Save/Update Text</a>                                   
                    <a class="nav-link" href="/text-to-speech/updateProfile">Update profile</a>                  
                </div>
              </div>
            </div>
            <div class="col-sm-3">
              <h6 th:text="'Hello '+${session.sessionEmailId}" style="color:white; font-weight:bold; margin-left:90%"/>
            </div>
            <div class="col-sm-3">
              <a href="/logout"><button class="btn btn-primary" style="font-weight:bold; width:30%; margin-left:55%"><i class="bi bi-door-open-fill"></i>&nbsp;&nbsp;Logout</button></a>
            </div>
          </nav>
        </div>
      </div>
      <div class="row">
        <div class="col-sm-3">
            <div class="customNav navbar-dark bg-dark">
              <div th:if="${listData.size} eq 0">
                <center><p class="nilRecord"><i class="bi bi-bookmark-plus-fill"></i>&nbsp;&nbsp;No data saved in your account</p></center>
             </div>             
             <div th:if="${listData.size} gt 0" style="padding-top:7%">
                <center><span style="padding:20px; font-size:20px; font-weight:600;"><i class="bi bi-bookmark-plus-fill"></i>&nbsp;&nbsp;Saved Records</span></center><br>
                <div th:each="record:${listData}" style="padding-top:3%;">
                  <div class="row" style="padding-left:10%">                    
                    <div class="col-sm-9">
                      <a class="cutsomAnchor" th:href="'/text-to-speech/update/'+${record._id}"><span th:text="${record.textTitle}" class="records"></span></a><br>
                      <small th:text="'last updated '+${record.lastModified}"/>
                    </div>
                    <div class="col-sm-3">
                      <a th:href="'/text-to-speech/delete/'+${record._id}"><button class="btn btn-danger" style="border-radius:50%;"><i class="bi bi-trash-fill"></i></button></a>
                    </div>                    
                  </div>
                  <br>
                </div>
             </div>
            </div>
        </div>
        <div class="col-sm">
          <div class="container" style="margin-left:10%; width:80%; margin-top:5%; background-color:#FFFFFF; padding:50px;">
            <h5 style="padding:15px; color:white; background-color:black;"><i class="bi bi-file-text-fill"></i>&nbsp;&nbsp;TextToSpeech&nbsp;&nbsp;<i class="bi bi-file-music-fill"></i></h5><br>
            <div class="row" style="margin-left:5%;">    
              <div class="col-sm-8">
                <form action="/saveText" method="post">
                  <div class="mb-3">
                    <label class="form-label" style="font-size:20px"><b><i class="bi bi-file-earmark-font-fill"></i>&nbsp;&nbsp;Enter title name</b></label>
                    <input type="text" style="width:100%;" class="form-control" name="textTitle" placeholder="Enter title name" autocomplete="off" required>                  
                  </div><br>
                  <div class="mb-3">
                    <label class="form-label" style="font-size:20px"><b><i class="bi bi-file-text-fill"></i>&nbsp;&nbsp;Enter any text inside space</b></label>
                    <textarea id="textArea" style="width:100%;" class="form-control" name="textContent" rows="10" placeholder="Type or paste text here to speech or save" autocomplete="off" required></textarea>
                  </div><br>                
                  <button class="btn btn-dark mb-3" type="submit" style="width:40%"><i class="bi bi-save2-fill"></i>&nbsp;&nbsp;Save Text</button>
                  <audio loop="false" width="0" height="0" id="sound" src="http://responsivevoice.org/wp-content/uploads/2015/06/Peppy-The-Firing-Squad_YMXB-160.mp3" type="audio/mp3" ></audio>
                </form>
              </div>  
              <div class="col-sm-4">
                <div class="row">
                  <center><span style="font-size:20px; font-weight:bold;">Play plain Text</span><br><br></center>
                  <center><button title="play plain text" class="btn btn-danger" onclick="playText()" style="border-radius:50%;"><i class="bi bi-play-circle-fill" style="padding:10px; font-size:50px;"></i></button></center>
                </div><br>
                <div class="row">
                  <center><span style="font-size:20px; font-weight:bold;">Play with audio</span><br><br></center>
                  <center><button title="play with background audio" class="btn btn-danger" onclick="playTextWithAudio()" style="border-radius:50%;"><i class="bi bi-music-note-list" style="padding:10px; font-size:50px;"></i></button></center>
                </div><br>
                <div class="row">
                  <center><span style="font-size:20px; font-weight:bold;">Stop audio</span><br><br></center>
                  <center><button title="play without background audio" class="btn btn-danger" onclick="stopAudio()" style="border-radius:50%;"><i class="bi bi-volume-mute-fill" style="padding:10px; font-size:50px;"></i></button></center>
                </div><br>
              </div>        
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <script>
      function playText(){    
        if(document.getElementById("textArea").value==""){
          swal({
          title: "Blank Text Area!",
          text: "Please enter some texts!!",
          icon: "info",          
          });
        }          
        else    
          responsiveVoice.speak(document.getElementById("textArea").value)
          document.getElementById("sound").pause()
      }

      function playTextWithAudio(){
        if(document.getElementById("textArea").value=="")
          playText()
        else{
          responsiveVoice.speak(document.getElementById("textArea").value)
          document.getElementById("sound").play()
        }        
      }

      function stopAudio(){
        document.getElementById("sound").pause()
      }

      function getSelectionText() {
        var text = "";
        if(window.getSelection) {
          text = window.getSelection().toString();                
        }
        else if (document.selection && document.selection.type != "Control") {
          text = document.selection.createRange().text;
        }
          return text;
      }

      $(document).ready(function (){
        $(document).mouseup(function (e){
          setTimeout(function() {
            responsiveVoice.cancel();
            responsiveVoice.speak(getSelectionText())
          }, 1);
        });
      });
    </script>
</body>
</html>